<!DOCTYPE html>

<html class="no-js">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title></title>
  <meta name="description" content="" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.7/vue.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/element-ui/2.4.9/theme-chalk/index.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/element-ui/2.4.9/index.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css" />
  <link rel="stylesheet" href="/lib/index.css" />
  <link rel="stylesheet" href="./css/style.css" />
  <link rel="stylesheet" href="./css/common.css" />
  <link rel="stylesheet" href="./css/iconfont.css" />
  <link rel="stylesheet" href="../../cdn/codemirror/codemirror.css" />
  <link rel="stylesheet" href="../../cdn/codemirror/theme/rubyblue.css" />
  <link rel="stylesheet" href="../../cdn/codemirror/addon/lint/lint.css" />
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1117329_cx316d9zsd.css">
  <script src="../../cdn/codemirror/codemirror.js"></script>
  <script src="../../cdn/codemirror/addon/lint/lint.js"></script>
  <script src="../../cdn/codemirror/mode/javascript/javascript.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/4.2.1/echarts.min.js"></script>
  <script src="../../cdn/echarts-wordcloud.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/sortablejs@1.8.4/Sortable.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/2.19.2/vuedraggable.umd.min.js"></script>
  <script src="./js/map.js"></script>
  <script src="./js/colorOption.js"></script>
  <script src="./js/vOption.js"></script>
  <script src="./js/dicOption.js"></script>
  <script src="./js/baseList.js"></script>
  <script src="./js/utils.js"></script>
  <script src="/lib/avue.js"></script>
</head>

<body>
  <div id="app" v-clock>
    <el-dialog title="复制代码" :visible.sync="dialogVisible">
      <div class="json-editor">
        <textarea ref="code" name="code"></textarea>
      </div>
    </el-dialog>
    <div class="contentmenu" v-show="contentMenu" :style="styleContentmenu" @click="contentMenu=false">
      <div class="contentmenu__item" @click="handleDel(active,zIndex)"> <i class="el-icon-close"></i>删除图层
      </div>
      <div class="contentmenu__item" @click="handleCopy(active,zIndex)"><i class="el-icon-document"></i>复制图层
      </div>
      <div class="contentmenu__item" @click="handleTop(active,zIndex)"><i class="el-icon-arrow-up"></i>置顶图层
      </div>
      <div class="contentmenu__item" @click="handleBottom(active,zIndex)"><i class="el-icon-arrow-down"></i>置底图层
      </div>
      <div class="contentmenu__item" @click="handleStepTop(active,zIndex)"><i class="el-icon-arrow-up"></i>上移一层
      </div>
      <div class="contentmenu__item" @click="handleStepBottom(active,zIndex)"><i class="el-icon-arrow-down"></i>下移一层
      </div>
    </div>
    <el-menu class="nav" mode="horizontal" background-color="#212528" text-color="#fff" active-text-color="#409EFF"
      @mousedown="handleMouseDown">
      <el-submenu :index="index+''" v-for="(item,index) in baseList" :key="index">
        <template slot="title">
          <i :class="'nav__icon iconfont '+item.icon"></i>
          <span>{{item.label}}</span>
        </template>
        <el-menu-item @click="addCompoment(citem.option)" :key="cindex" :index="`${index}-${cindex}`"
          v-for="(citem,cindex) in item.children">
          <i :class="'nav__icon iconfont '+citem.option.icon"></i>
          <span>{{citem.label}}</span>
        </el-menu-item>
      </el-submenu>
      <el-menu-item index="6" @click="handleReset" v-show="!menuFlag">
        <i class="nav__icon iconfont icon-reset"></i>
        <span>还原</span>
      </el-menu-item>
      <el-menu-item index="7" @click="handleView" v-show="menuFlag">
        <i class="nav__icon iconfont icon-view"></i>
        <span>预览</span>
      </el-menu-item>
      <el-menu-item index="8" @click="handleBuild">
        <i class="nav__icon iconfont icon-build"></i>
        <span>生成</span>
      </el-menu-item>

    </el-menu>
    <div class="app" :class="{'app--none':!menuFlag}">
      <div class="menu" v-show="menuFlag" @mousedown="handleMouseDown">
        <p class="title">图层</p>
        <draggable v-model="zIndexList">
          <div class="menu__item" :class="{'menu__item--active':item.index===active}" v-for="(item,index) in zIndexList"
            :key="index" @click="active=item.index">
            <span class="menu__icon">
              <i :class="'iconfont '+item.icon"></i>
            </span>
            <span>{{item.title}}</span>
          </div>
        </draggable>
      </div>
      <div class="middle">
        <div class="grade wrapper__grade" @mousedown.self="handleMouseDown"></div>
        <div class="wrapper" @mousedown.self="handleMouseDown">
          <div class="content" ref="content" @mousedown.self="handleMouseDown">
            <div class="container" :style="styleName" ref="container" @mousedown.self="handleMouseDown"
              @contextmenu.prevent="handleContextMenu">
              <div class="grade" v-if="gradeFlag || config.gradeShow" :style="gradeLenStyle"></div>
              <avue-draggable v-if="relaod" :disabled="!menuFlag" :ref="'item_'+index" :id="'item_'+index" :step="5"
                @focus="handleFocus" @postion="handlePostion" :resize="item.resize" @resize="handleResize"
                @blur="handleBlur" @change="handleChange" :index="index" :z-index="item.zIndex"
                v-for="(item,index) in list" :width="item.component.width" :height="item.component.height" :key="index"
                :top="item.top" :left="item.left">
                <component :id="'component_'+index" :animation="!menuFlag" :is="'avue-echart-'+item.component.name"
                  :component="item.component" :data="item.data" :option="item.component.option" :url="item.url"
                  :time="item.time" :data-type="item.dataType">
                </component>
                <template slot-scope="scope" slot="menu">
                  <i class="el-icon-close" @click="handleDel(scope.index,scope.zIndex)"></i>
                  <i class="el-icon-document" @click="handleCopy(scope.index,scope.zIndex)"></i>
                </template>
              </avue-draggable>
            </div>
          </div>

        </div>
      </div>

      <div class="menu params" v-show="menuFlag">
        <p class="title">操作</p>
        <el-form label-width="120px" label-position="left" size="small">
          <template v-if="![undefined].includes(activeComponent.prop)">
            <el-collapse>
              <el-collapse-item title="数据设置" v-if="dicOption.dataList.includes(activeComponent.prop)">
                <el-form-item label="数据类型">
                  <avue-radio v-model="activeObj.dataType" :dic="dicOption.dataType"></avue-radio>
                </el-form-item>
                <el-form-item label="数据值" v-if="activeObj.dataType===0">
                  <avue-input type="textarea" v-model="jsonData" :minRows="15"></avue-input>
                </el-form-item>
                <template v-if="activeObj.dataType===1">
                  <el-form-item label="接口地址">
                    <avue-input v-model="activeObj.url"></avue-input>
                  </el-form-item>
                  <el-form-item label="刷新时间">
                    <avue-input-number v-model="activeObj.time"></avue-input-number>
                  </el-form-item>
                </template>
              </el-collapse-item>
            </el-collapse>
            <el-form-item label="图层名称">
              <avue-input v-model="activeObj.name"></avue-input>
            </el-form-item>
            <template v-if="activeComponent.prop==='img'">
              <el-form-item label="开启旋转">
                <avue-switch v-model="activeComponent.option.rotate"></avue-switch>
              </el-form-item>
              <template v-if="activeComponent.option.rotate">
                <el-form-item label="旋转时间">
                  <avue-input-number v-model="activeComponent.option.duration"></avue-input-number>
                </el-form-item>
              </template>

            </template>
            <template v-if="activeComponent.prop==='wordCloud'">
              <el-form-item label="最小字体">
                <avue-input-number v-model="activeComponent.option.minFontSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="最大字体">
                <avue-input-number v-model="activeComponent.option.maxFontSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="间距">
                <avue-input-number v-model="activeComponent.option.split"></avue-input-number>
              </el-form-item>
              <el-form-item label="旋转">
                <avue-switch v-model="activeComponent.option.rotate"></avue-switch>
              </el-form-item>
            </template>
            <template v-if="activeComponent.prop==='pictorialBar'">

              <el-form-item label="图标">
                <img :src="activeComponent.option.symbol" width="60" />
                <avue-input v-model="activeComponent.option.symbol"></avue-input>
              </el-form-item>
              <el-form-item label="图标字号">
                <avue-input-number v-model="activeComponent.option.symbolSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="字体颜色">
                <avue-color v-model="activeComponent.option.color"></avue-color>
              </el-form-item>
              <el-form-item label="轴字体颜色">
                <avue-color v-model="activeComponent.option.nameColor"></avue-color>
              </el-form-item>
              <el-form-item label="间距">
                <avue-silder v-model="activeComponent.option.split"></avue-silder>
              </el-form-item>
              <el-collapse>
                <el-collapse-item title="X轴设置">
                  <el-form-item label="显示">
                    <avue-switch v-model="activeComponent.option.xAxisShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="字号">
                    <avue-input-number v-model="activeComponent.option.xNameFontSize">
                    </avue-input-number>
                  </el-form-item>
                </el-collapse-item>
                <el-collapse-item title="Y轴设置">
                  <el-form-item label="显示">
                    <avue-switch v-model="activeComponent.option.yAxisShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="字号">
                    <avue-input-number v-model="activeComponent.option.yNameFontSize">
                    </avue-input-number>
                  </el-form-item>
                </el-collapse-item>
              </el-collapse>
            </template>
            <template v-if="activeComponent.prop==='swiper'">
              <el-form-item label="类型">
                <avue-radio v-model="activeComponent.option.type" :dic="dicOption.swiperType"></avue-radio>
              </el-form-item>
              <el-form-item label="轮播时间">
                <avue-input v-model="activeComponent.option.interval"></avue-input>
              </el-form-item>
              <el-form-item label="选择器">
                <avue-radio v-model="activeComponent.option.indicator" :dic="dicOption.swiperIndicator"></avue-radio>
              </el-form-item>
              <el-form-item label="图片透明度">
                <avue-silder v-model="activeComponent.option.opacity"></avue-silder>
              </el-form-item>
            </template>
            <template v-if="activeComponent.prop==='gauge'">
              <el-form-item label="刻度线粗度(像素)">
                <avue-input-number v-model="activeComponent.option.lineSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="显示刻度值">
                <avue-switch v-model="activeComponent.option.axisLabelShow"></avue-switch>
              </el-form-item>
              <el-form-item label="刻度字号">
                <avue-input-number v-model="activeComponent.option.axisLabelFontSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="指标名称字号">
                <avue-input-number v-model="activeComponent.option.nameFontSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="指标字号">
                <avue-input-number v-model="activeComponent.option.valueFontSize"></avue-input-number>
              </el-form-item>
            </template>
            <template v-if="activeComponent.prop==='text'">
              <el-form-item label="文本内容">
                <avue-input v-model="activeObj.data"></avue-input>
              </el-form-item>
              <el-form-item label="字体大小">
                <avue-input-number v-model="activeComponent.option.fontSize" :max="200"></avue-input-number>
              </el-form-item>
              <el-form-item label="字体颜色">
                <avue-color v-model="activeComponent.option.color"></avue-color>
              </el-form-item>
              <el-form-item label="字体间距">
                <avue-silder v-model="activeComponent.option.split"></avue-silder>
              </el-form-item>
              <el-form-item label="字体背景">
                <avue-color v-model="activeComponent.option.backgroundColor"></avue-color>
              </el-form-item>
              <el-form-item label="文字粗细">
                <avue-select v-model="activeComponent.option.fontWeight" :dic="dicOption.fontWeight">
                </avue-select>
              </el-form-item>
              <el-form-item label="对齐方式">
                <avue-select v-model="activeComponent.option.textAlign" :dic="dicOption.textAlign">
                </avue-select>
              </el-form-item>
              <el-collapse>
                <el-collapse-item title="跑马灯设置">
                  <el-form-item label="开启">
                    <avue-switch v-model="activeComponent.option.scroll"></avue-switch>
                  </el-form-item>
                  <template v-if="activeComponent.option.scroll">
                    <el-form-item label="滚动速度">
                      <avue-input v-model="activeComponent.option.speed"></avue-input>
                    </el-form-item>
                  </template>
                </el-collapse-item>
                <el-collapse-item title="超链设置">
                  <el-form-item label="开启">
                    <avue-switch v-model="activeComponent.option.link"></avue-switch>
                  </el-form-item>
                  <template v-if="activeComponent.option.link">
                    <el-form-item label="打开方式">
                      <avue-radio v-model="activeComponent.option.linkTarget" :dic="dicOption.target"></avue-radio>
                    </el-form-item>
                    <el-form-item label="超链地址">
                      <avue-input v-model="activeComponent.option.linkHref"></avue-input>
                    </el-form-item>
                  </template>
                </el-collapse-item>
              </el-collapse>
            </template>
            <template v-else-if="activeComponent.prop==='datetime'">
              <el-form-item label="时间格式">
                <avue-select v-model="activeComponent.option.format" :dic="dicOption.format">
                </avue-select>
              </el-form-item>
              <el-form-item label="字体大小">
                <avue-input-number v-model="activeComponent.option.fontSize" :max="200"></avue-input-number>
              </el-form-item>
              <el-form-item label="字体背景">
                <avue-color v-model="activeComponent.option.backgroundColor"></avue-color>
              </el-form-item>
              <el-form-item label="对其方式">
                <avue-select v-model="activeComponent.option.textAlign" :dic="dicOption.textAlign">
                </avue-select>
              </el-form-item>
              <el-form-item label="文字粗细">
                <avue-select v-model="activeComponent.option.fontWeight" :dic="dicOption.fontWeight">
                </avue-select>
              </el-form-item>
              <el-form-item label="字体颜色">
                <avue-color v-model="activeComponent.option.color"></avue-color>
              </el-form-item>
            </template>
            <template v-else-if="activeComponent.prop==='img'">
              <el-form-item label="缩略图">
                <img :src="activeObj.data" alt="" width="100%" />
              </el-form-item>
              <el-form-item label="图片地址">
                <avue-input v-model="activeObj.data"></avue-input>
              </el-form-item>
            </template>
            <template v-else-if="activeComponent.prop==='progress'">
              <el-form-item label="类型">
                <avue-radio v-model="activeComponent.option.type" :dic="dicOption.line">
                </avue-radio>
              </el-form-item>
              <el-form-item label="间距">
                <avue-input-number v-model="activeComponent.option.split" :max="200"></avue-input-number>
              </el-form-item>
              <el-form-item label="边框颜色">
                <avue-color v-model="activeComponent.option.borderColor"></avue-color>
              </el-form-item>
              <el-form-item label="边框大小">
                <avue-input-number v-model="activeComponent.option.strokeWidth" :max="50"></avue-input-number>
              </el-form-item>
              <el-form-item label="字体大小">
                <avue-input-number v-model="activeComponent.option.fontSize" :max="200"></avue-input-number>
              </el-form-item>
              <el-form-item label="字体颜色">
                <avue-color v-model="activeComponent.option.color"></avue-color>
              </el-form-item>
              <el-form-item label="文字粗细">
                <avue-select v-model="activeComponent.option.FontWeight" :dic="dicOption.fontWeight">
                </avue-select>
              </el-form-item>
              <el-form-item label="前缀字体大小">
                <avue-input-number v-model="activeComponent.option.suffixFontSize" :max="200"></avue-input-number>
              </el-form-item>
              <el-form-item label="前缀字体颜色">
                <avue-color v-model="activeComponent.option.suffixColor"></avue-color>
              </el-form-item>
              <el-form-item label="前缀文字粗细">
                <avue-select v-model="activeComponent.option.suffixFontWeight" :dic="dicOption.fontWeight">
                </avue-select>
              </el-form-item>
            </template>
            <template v-else-if="activeComponent.prop==='map'">
              <el-form-item label="地图类型">
                <avue-radio v-model="activeComponent.option.type" :dic="dicOption.mapType"></avue-radio>
              </el-form-item>
              <el-form-item label="开启轮播">
                <avue-switch v-model="activeComponent.option.banner"></avue-switch>
              </el-form-item>
              <template v-if="activeComponent.option.banner">
                <el-form-item label="轮播时间">
                  <avue-input v-model="activeComponent.option.bannerTime"></avue-input>
                </el-form-item>
              </template>
              <template v-if="activeComponent.option.type===0">
                <el-form-item label="地图选择">
                  <el-select v-model="activeComponent.option.mapKey" @change="handleMapSelect" placeholder="请选择区域选择">
                    <el-option v-for="item in dicOption.mapList" :key="item.value" :label="item.label"
                      :value="item.value">
                    </el-option>
                  </el-select>
                </el-form-item>
                <el-form-item label="字体大小">
                  <avue-input-number v-model="activeComponent.option.fontSize"></avue-input-number>
                </el-form-item>
                <el-form-item label="字体高亮颜色">
                  <avue-color v-model="activeComponent.option.empColor"></avue-color>
                </el-form-item>
                <el-form-item label="字体颜色">
                  <avue-color v-model="activeComponent.option.color"></avue-color>
                </el-form-item>
                <el-form-item label="区域线">
                  <avue-input-number v-model="activeComponent.option.borderWidth"></avue-input-number>
                </el-form-item>
                <el-form-item label="区域颜色">
                  <avue-color v-model="activeComponent.option.areaColor"></avue-color>
                </el-form-item>
                <el-form-item label="区域高亮颜色">
                  <avue-color v-model="activeComponent.option.empAreaColor"></avue-color>
                </el-form-item>
                <el-form-item label="边框颜色">
                  <avue-color v-model="activeComponent.option.borderColor"></avue-color>
                </el-form-item>
              </template>
              <template v-if="activeComponent.option.type===1">
                <el-form-item label="图片地址">
                  <avue-input v-model="activeComponent.option.img"></avue-input>
                </el-form-item>
                <el-form-item label="地图比例">
                  <avue-silder v-model="activeComponent.option.scale" :max="300"></avue-silder>
                </el-form-item>
              </template>
            </template>
            <template v-else-if="activeComponent.prop==='flop'">
              <el-form-item label="字体大小">
                <avue-input-number v-model="activeComponent.option.fontSize" :max="200"></avue-input-number>
              </el-form-item>
              <el-form-item label="字体颜色">
                <avue-color v-model="activeComponent.option.color"></avue-color>
              </el-form-item>
              <el-form-item label="文字粗细">
                <avue-select v-model="activeComponent.option.fontWeight" :dic="dicOption.fontWeight">
                </avue-select>
              </el-form-item>
              <el-form-item label="横行排列">
                <avue-switch v-model="activeComponent.option.row">
                </avue-switch>
              </el-form-item>
              <el-form-item label="边框X间距">
                <avue-silder v-model="activeComponent.option.splitx"></avue-silder>
              </el-form-item>
              <el-form-item label="边框Y间距">
                <avue-silder v-model="activeComponent.option.splity"></avue-silder>
              </el-form-item>
              <el-form-item label="边框宽度">
                <avue-input-number v-model="activeComponent.option.width" :max="1000"></avue-input-number>
              </el-form-item>
              <el-form-item label="边框高度">
                <avue-input-number v-model="activeComponent.option.height" :max="1000"></avue-input-number>
              </el-form-item>
              <el-form-item label="对其方式">
                <avue-select v-model="activeComponent.option.textAlign" :dic="dicOption.textAlign">
                </avue-select>
              </el-form-item>
              <el-form-item label="并排">
                <avue-switch v-model="activeComponent.option.warp">
                </avue-switch>
              </el-form-item>
              <el-form-item label="整体框">
                <avue-switch v-model="activeComponent.option.whole">
                </avue-switch>
              </el-form-item>
              <el-form-item label="边框">
                <avue-radio v-model="activeComponent.option.type" :dic="dicOption.border">
                </avue-radio>
              </el-form-item>
              <template v-if="activeComponent.option.type==='img'">
                <el-form-item label="背景图片">
                  <img :src="item" v-for="(item,index) in dicOption.borderList" :key="index"
                    @click="activeComponent.option.backgroundImage=item">
                </el-form-item>
              </template>
              <template v-else-if="activeComponent.option.type==='border'">
                <el-form-item label="边框颜色">
                  <avue-color v-model="activeComponent.option.borderColor"></avue-color>
                </el-form-item>
                <el-form-item label="边框宽度">
                  <avue-input-number v-model="activeComponent.option.borderWidth" :max="10"></avue-input-number>
                </el-form-item>
              </template>
              <el-form-item label="背景颜色">
                <avue-color v-model="activeComponent.option.backgroundColor"></avue-color>
              </el-form-item>
              <el-collapse>
                <el-collapse-item title="前缀设置">
                  <template v-if="!activeComponent.option.whole">
                    <el-form-item label="前缀内容">
                      <avue-input v-model="activeComponent.option.prefixText"></avue-input>
                    </el-form-item>
                  </template>
                  <template v-if="!activeComponent.option.row">
                    <el-form-item label="对其方式">
                      <avue-select v-model="activeComponent.option.prefixTextAlign" :dic="dicOption.textAlign">
                      </avue-select>
                    </el-form-item>
                  </template>
                  <el-form-item label="X间距">
                    <avue-silder v-model="activeComponent.option.prefixSplitx"></avue-silder>
                  </el-form-item>
                  <el-form-item label="Y间距">
                    <avue-silder v-model="activeComponent.option.prefixSplity"></avue-silder>
                  </el-form-item>
                  <el-form-item label="颜色">
                    <avue-color v-model="activeComponent.option.prefixColor"></avue-color>
                  </el-form-item>
                  <el-form-item label="字体大小">
                    <avue-input-number v-model="activeComponent.option.prefixFontSize" :max="200"></avue-input-number>
                  </el-form-item>
                </el-collapse-item>
                <el-collapse-item title="后缀设置">
                  <template v-if="!activeComponent.option.whole">
                    <el-form-item label="后缀内容">
                      <avue-input v-model="activeComponent.option.suffixText"></avue-input>
                    </el-form-item>
                  </template>
                  <template v-if="!activeComponent.option.row">
                    <el-form-item label="对其方式">
                      <avue-select v-model="activeComponent.option.suffixTextAlign" :dic="dicOption.textAlign">
                      </avue-select>
                    </el-form-item>
                  </template>
                  <el-form-item label="X间距">
                    <avue-silder v-model="activeComponent.option.suffixSplitx"></avue-silder>
                  </el-form-item>
                  <el-form-item label="Y间距">
                    <avue-silder v-model="activeComponent.option.suffixSplity"></avue-silder>
                  </el-form-item>
                  <el-form-item label="颜色">
                    <avue-color v-model="activeComponent.option.suffixColor"></avue-color>
                  </el-form-item>
                  <el-form-item label="字体大小">
                    <avue-input-number v-model="activeComponent.option.suffixFontSize" :max="200"></avue-input-number>
                  </el-form-item>
                </el-collapse-item>
              </el-collapse>
            </template>
            <template v-else-if="activeComponent.prop==='table'">
              <el-form-item label="表头颜色">
                <avue-color type="textarea" v-model="activeComponent.option.headerColor"></avue-color>
              </el-form-item>
              <el-form-item label="表头背景">
                <avue-color type="textarea" v-model="activeComponent.option.headerBackgroud"></avue-color>
              </el-form-item>
              <el-form-item label="字体位置">
                <avue-select v-model="activeComponent.option.headerTextAlign" :dic="dicOption.textAlign">
                </avue-select>
              </el-form-item>
              <el-form-item label="字体大小">
                <avue-input-number v-model="activeComponent.option.fontSize">
                </avue-input-number>
              </el-form-item>
              <el-form-item label="显示行数">
                <avue-input-number v-model="activeComponent.option.count">
                </avue-input-number>
              </el-form-item>
              <el-form-item label="开启滚动">
                <avue-switch v-model="activeComponent.option.scroll">
                </avue-switch>
              </el-form-item>
              <template v-if="activeComponent.option.scroll">
                <el-form-item label="滚动时间">
                  <avue-input-number v-model="activeComponent.option.scrollTime">
                  </avue-input-number>
                </el-form-item>
                <el-form-item label="滚动行数">
                  <avue-input-number v-model="activeComponent.option.scrollCount">
                  </avue-input-number>
                </el-form-item>
              </template>
              <el-form-item label="线条">
                <avue-switch v-model="activeComponent.option.line"></avue-switch>
              </el-form-item>
              <el-form-item label="开启排名">
                <avue-switch v-model="activeComponent.option.index"></avue-switch>
              </el-form-item>
              <el-form-item label="文字颜色">
                <avue-color type="textarea" v-model="activeComponent.option.bodyColor"></avue-color>
              </el-form-item>
              <el-form-item label="表格背景">
                <avue-color type="textarea" v-model="activeComponent.option.bodyBackgroud"></avue-color>
              </el-form-item>
              <el-form-item label="字体位置">
                <avue-select v-model="activeComponent.option.bodyTextAlign" :dic="dicOption.textAlign">
                </avue-select>
              </el-form-item>
              <el-form-item label="分割线">
                <avue-color type="textarea" v-model="activeComponent.option.borderColor"></avue-color>
              </el-form-item>
              <el-form-item label="奇行颜色">
                <avue-color type="textarea" v-model="activeComponent.option.nthColor"></avue-color>
              </el-form-item>
              <el-form-item label="偶行颜色">
                <avue-color type="textarea" v-model="activeComponent.option.othColor"></avue-color>
              </el-form-item>
              <avue-crud :option="tableOption" :data="activeComponent.option.column" @row-save="rowSave"
                @row-del="rowDel" @row-update="rowUpdate"></avue-crud>
            </template>
            <template v-else-if="activeComponent.prop==='pie'">
              <el-form-item label="设置为环形">
                <avue-switch v-model="activeComponent.option.radius"></avue-switch>
              </el-form-item>
              <el-form-item label="南丁格尔玫瑰">
                <avue-switch v-model="activeComponent.option.roseType"></avue-switch>
              </el-form-item>
              <el-form-item label="自动按数据大小排序">
                <avue-switch v-model="activeComponent.option.sort"></avue-switch>
              </el-form-item>
              <el-form-item label="不展示为零数据项">
                <avue-switch v-model="activeComponent.option.notCount"></avue-switch>
              </el-form-item>
              <el-form-item label="显示标题">
                <avue-switch v-model="activeComponent.option.labelShow"></avue-switch>
              </el-form-item>
              <el-form-item label="标题大小">
                <avue-input-number v-model="activeComponent.option.fontSize"></avue-input-number>
              </el-form-item>
            </template>
            <template v-else-if="['bar','line'].includes(activeComponent.prop)">
              <el-form-item label="标题">
                <avue-input type="textarea" v-model="activeComponent.option.title"></avue-input>
              </el-form-item>
              <el-form-item label="标题大小">
                <avue-input-number v-model="activeComponent.option.titleFontSize"></avue-input-number>
              </el-form-item>
              <el-form-item label="标题颜色">
                <avue-color v-model="activeComponent.option.titleColor"></avue-color>
              </el-form-item>
              <el-form-item label="标题对齐">
                <avue-select v-model="activeComponent.option.titlePostion" :dic="dicOption.textAlign">
                </avue-select>
              </el-form-item>
              <el-form-item label="标题隐藏">
                <avue-switch v-model="activeComponent.option.titleShow"></avue-switch>
              </el-form-item>
              <el-form-item label="标题链接">
                <avue-input type="textarea" v-model="activeComponent.option.titleLink"></avue-input>
              </el-form-item>

              <el-form-item label="竖展示">
                <avue-switch type="textarea" v-model="activeComponent.option.category"></avue-switch>
              </el-form-item>
              <template v-if="['line'].includes(activeComponent.prop)">
                <el-form-item label="面积堆积">
                  <avue-switch v-model="activeComponent.option.areaStyle"></avue-switch>
                </el-form-item>
                <el-form-item label="线条宽度">
                  <avue-input-number v-model="activeComponent.option.lineWidth"></avue-input-number>
                </el-form-item>
              </template>
              <el-collapse>
                <el-collapse-item title="X轴设置">
                  <el-form-item label="显示">
                    <avue-switch v-model="activeComponent.option.xAxisShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="显示网格线">
                    <avue-switch v-model="activeComponent.option.xAxisSplitLineShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="轴反转">
                    <avue-switch v-model="activeComponent.option.xAxisInverse">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="字号">
                    <avue-input-number v-model="activeComponent.option.xNameFontSize">
                    </avue-input-number>
                  </el-form-item>
                </el-collapse-item>
                <el-collapse-item title="Y轴设置">
                  <el-form-item label="显示">
                    <avue-switch v-model="activeComponent.option.yAxisShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="轴网格线">
                    <avue-switch v-model="activeComponent.option.yAxisSplitLineShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="反转">
                    <avue-switch v-model="activeComponent.option.yAxisInverse">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="字号">
                    <avue-input-number v-model="activeComponent.option.yNameFontSize">
                    </avue-input-number>
                  </el-form-item>
                </el-collapse-item>

                <el-collapse-item title="数字提示设置">
                  <el-form-item label="显示">
                    <avue-switch v-model="activeComponent.option.labelShow">
                    </avue-switch>
                  </el-form-item>
                  <el-form-item label="字体大小">
                    <avue-input-number v-model="activeComponent.option.labelShowFontSize">
                    </avue-input-number>
                  </el-form-item>
                  <el-form-item label="字体颜色">
                    <avue-color v-model="activeComponent.option.labelShowColor">
                    </avue-color>
                  </el-form-item>
                  <el-form-item label="字体粗细">
                    <avue-select v-model="activeComponent.option.labelShowFontWeight" :dic="dicOption.fontWeight">
                    </avue-select>
                  </el-form-item>
                </el-collapse-item>
                <template v-if="['bar'].includes(activeComponent.prop)">
                  <el-collapse-item title="柱体设置">
                    <el-form-item label="最大宽度">
                      <avue-silder v-model="activeComponent.option.barWidth">
                      </avue-silder>
                    </el-form-item>
                    <el-form-item label="圆角">
                      <avue-silder v-model="activeComponent.option.barRadius">
                      </avue-silder>
                    </el-form-item>
                    <el-form-item label="最小高度">
                      <avue-silder v-model="activeComponent.option.barMinHeight">
                      </avue-silder>
                    </el-form-item>
                  </el-collapse-item>
                </template>
              </el-collapse>
            </template>
            <template v-if="dicOption.colorList.includes(activeComponent.prop)">
              <el-collapse>
                <el-collapse-item title="坐标轴边距设置">
                  <el-form-item label="图例">
                    <avue-switch v-model="activeComponent.option.legendShow"></avue-switch>
                  </el-form-item>
                  <el-form-item label="左边距(像素)">
                    <avue-silder v-model="activeComponent.option.gridX" max="200"></avue-silder>
                  </el-form-item>
                  <el-form-item label="顶边距(像素)">
                    <avue-silder v-model="activeComponent.option.gridY" max="200"></avue-silder>
                  </el-form-item>
                  <el-form-item label="右边距(像素)">
                    <avue-silder v-model="activeComponent.option.gridX2" max="200"></avue-silder>
                  </el-form-item>
                  <el-form-item label="底边距(像素)">
                    <avue-silder v-model="activeComponent.option.gridY2" max="200"></avue-silder>
                  </el-form-item>
                </el-collapse-item>
                <el-collapse-item title="自定义配色">
                  <el-form-item label="文字颜色">
                    <avue-color v-model="activeComponent.option.nameColor">
                    </avue-color>
                  </el-form-item>
                  <el-form-item label="轴线颜色">
                    <avue-color v-model="activeComponent.option.lineColor"></avue-color>
                  </el-form-item>
                  <avue-crud :option="colorOption" :data="activeComponent.option.barColor" @row-save="rowSave"
                    @row-del="rowDel" @row-update="rowUpdate"></avue-crud>
                </el-collapse-item>
              </el-collapse>
            </template>
          </template>

          <template v-else>
            <el-form-item label="大屏名称">
              <avue-input v-model="config.name"></avue-input>
            </el-form-item>
            <el-form-item label="大屏宽度">
              <avue-input-number v-model="config.width"></avue-input-number>
            </el-form-item>
            <el-form-item label="大屏高度">
              <avue-input-number v-model="config.height"></avue-input-number>
            </el-form-item>
            <el-form-item label="背景图片">
              <img :src="item" class="img" width="80" v-for="(item,index) in dicOption.backgroundImage" :key="index"
                @click="config.backgroundImage=item">
            </el-form-item>
            <el-form-item label="缩放">
              <el-slider v-model="config.scale" :max="200" :format-tooltip="formatTooltip"></el-slider>
            </el-form-item>

            <el-form-item label="显示网格">
              <avue-switch v-model="config.gradeShow"></avue-switch>
            </el-form-item>
            <el-form-item label="网格间距">
              <avue-input-number v-model="config.gradeLen"></avue-input-number>
            </el-form-item>
          </template>
        </el-form>
      </div>
    </div>
  </div>
</body>
<script>
  new Vue({
    el: '#app',
    data() {
      return {
        contentWidth: 0,
        contentMenu: false,
        contentMenuX: 0,
        contentMenuY: 0,
        zIndex: 0,
        key: '',
        baseList: baseList,
        menuFlag: true,
        dialogVisible: false,
        CodeMirrorEditor: {},
        gradeFlag: false,
        relaod: true,
        form: {},
        dicOption: dicOption,
        tableOption: tableOption,
        colorOption: colorOption,
        config: config,
        active: -1,
        list: list
      }
    },
    computed: {
      jsonData: {
        get() {
          const data = this.activeObj.data
          if (this.isJson(data)) {
            return JSON.stringify(data, null, 4);
          }
          return '';
        },
        set(val) {
          let data = '';
          try {
            data = JSON.parse(val, null, 4);
          } catch {
            data = {};
          }
          this.activeObj.data = data
        },
      },
      styleContentmenu() {
        return {
          left: this.setPx(this.contentMenuX),
          top: this.setPx(this.contentMenuY)
        }
      },
      zIndexList: {
        set(val) {
          const leng = val.length;
          val.forEach((ele, index) => {
            const zIndex = leng - index;
            this.$set(this.list[ele.index], 'zIndex', zIndex)
          })
        },
        get() {
          let list = [];
          list = this.list.map(ele => {
            return {
              index: ele.index,
              title: ele.name,
              zIndex: ele.zIndex,
              icon: ele.icon
            }
          })
          list.sort(compare("zIndex"));
          return list;
        }
      },
      listLen() {
        return this.list.length || 0;
      },
      activeComponent() {
        return this.activeObj.component || {}
      },
      activeKey() {
        if (this.activeComponent.name === 'table') {
          return this.activeComponent.option.column
        } else if (['bar', 'line', 'pie', 'table'].includes(this.activeComponent.name)) {
          return this.activeComponent.option.barColor
        }
      },
      activeObj() {
        return this.list[this.active] || {}
      },
      activeNextObj() {
        return this.list[this.active - 1] || {}
      },
      activeBreakObj() {
        return this.list[this.active + 1] || {}
      },
      styleName() {
        const scale = this.config.scale;
        return {
          transform: `scale(${scale / 100}, ${scale / 100})`,
          background: `url(${this.config.backgroundImage}) 0% 0% / 100% 100% rgb(3, 12, 59)`,
          width: this.setPx(this.config.width),
          height: this.setPx(this.config.height)
        }
      },
      gradeLenStyle() {
        return {
          backgroundSize: `${this.setPx(this.config.gradeLen)} ${this.setPx(this.config.gradeLen)},${this.setPx(this.config.gradeLen)} ${this.setPx(this.config.gradeLen)}`
        }
      }
    },
    created() {
      this.initData();
    },
    mounted() {
      this.contentWidth = this.$refs.content.offsetWidth;
      this.setScale();
      this.setResize();
    },
    watch: {
      'config.width'() {
        this.setResize('width');
      },
      'config.height'() {
        this.setResize('height');
      },
      'config.scale'() {
        this.setResize();
      },
      menuFlag(val) {
        this.$nextTick(() => {
          this.setScale();
          this.setResize();
        })
      },
      active(val) {
        this.list.forEach((ele, index) => {
          this.$refs['item_' + index][0].setActive(index === val)
        });
      },
    },
    methods: {
      initData() {
        this.list.forEach((ele, index) => {
          this.$set(this.list, index, Object.assign(ele, {
            index,
            zIndex: (this.listLen - 1) - index
          }));
        })
      },
      setScale() {
        this.config.scale = (this.$refs.content.offsetWidth / this.config.width) * 100
      },
      setResize(type) {
        this.$nextTick(() => {
          if (type === 'width') {
            this.$refs.content.style.width = this.setPx((this.config.scale * this.config.width) / 100)
          } else if (type === 'height') {
            this.$refs.content.style.height = this.setPx((this.config.scale * this.config.height) / 100)
          } else {
            this.$refs.content.style.width = this.setPx((this.config.scale * this.config.width) / 100)
            this.$refs.content.style.height = this.setPx((this.config.scale * this.config.height) / 100)
          }
        })

      },
      formatTooltip(val) {
        return parseInt(val);
      },
      handleMouseDown() {
        this.active = -1;
        this.$nextTick(() => {
          this.contentMenu = false;
        })
      },
      handleTop(active) {
        this.activeObj.zIndex = this.listLen + 1;
      },
      handleStepTop(active) {
        this.activeObj.zIndex = this.activeObj.zIndex + 1;
        if (this.activeNextObj) this.activeNextObj.zIndex = this.activeNextObj.zIndex - 1;
      },
      handleStepBottom(active) {
        this.activeObj.zIndex = this.activeObj.zIndex - 1;
        if (this.activeBreakObj) this.activeBreakObj.zIndex = this.activeBreakObj.zIndex + 1
      },
      handleBottom(active) {
        this.list[active].zIndex = -1;
      },
      handleMapSelect(value) {
        this.activeComponent.option.mapList = this.dicOption.mapList[value].list;
      },
      handleContextMenu(e) {
        this.$nextTick(() => {
          if (this.active === -1) {
            this.contentMenu = false;
          } else {
            this.contentMenuX = e.clientX;
            this.contentMenuY = e.clientY;
            this.contentMenu = true;
          }
        })
      },
      handleChange(index, zindex) {
        this.active = index;
        this.zIndex = zindex;
        this.contentMenu = false;
      },
      handleFocus() {
        this.gradeFlag = true;
      },
      handleBlur() {
        this.gradeFlag = false;
      },
      handleDel(index, zIndex) {
        const obj = this.list[index]
        this.$confirm(`是否删除<<${obj.name}>>图层?`, '提示', {
          confirmButtonText: '确定',
          cancelButtonText: '取消',
          type: 'warning'
        }).then(() => {
          this.active = -1;
          this.list.splice(index, 1);
          this.relaod = false;
          this.$nextTick(() => {
            this.relaod = true;
          })
        }).catch(() => {

        });
      },
      handleCopy(index, zIndex) {
        const obj = this.list[index]
        this.$confirm(`是否复制<<${obj.name}>>图层?`, '提示', {
          confirmButtonText: '确定',
          cancelButtonText: '取消',
          type: 'warning'
        }).then(() => {
          this.addCompoment(obj);
        }).catch(() => {

        });
      },
      handleResize({ index, width, height }) {
        const ele = this.list[index].component;
        this.$set(ele, 'width', width)
        this.$set(ele, 'height', height)

      },
      handlePostion({ index, left, top }) {
        const ele = this.list[index];
        this.$set(ele, 'left', left)
        this.$set(ele, 'top', top)
      },
      rowSave(row, done) {
        this.activeKey.push(row);
        done()
      },
      rowDel(row, index) {
        this.activeKey.splice(index, 1);
      },
      rowUpdate(row, index, done) {
        this.activeKey.splice(index, 1, row);
        done()
      },
      addCompoment(option) {
        const obj = this.deepClone(option);
        obj.left = 0;
        obj.top = 0;
        obj.zIndex = this.listLen;
        obj.index = this.listLen;
        this.list.push(obj);
      },
      handleView() {
        this.$refs.content.style.width = '100%';
        this.menuFlag = false;
        this.active = -1;
      },
      handleReset() {
        this.$refs.content.style.width = this.setPx(this.contentWidth);
        this.menuFlag = true;
      },
      handleBuild() {
        this.dialogVisible = true;
        this.$nextTick(() => {
          this.CodeMirrorEditor = CodeMirror.fromTextArea(this.$refs.code, {
            lineNumbers: true,
            mode: 'application/json',
            gutters: ['CodeMirror-lint-markers'],
            theme: 'rubyblue',
            lint: true
          });
          this.CodeMirrorEditor.setValue(JSON.stringify(this.list, null, 2))
        })
      },
    }
  })
</script>

</html>